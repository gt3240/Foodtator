@model Foodtator.Models.ViewModels.BaseViewModel
@using Foodtator.Classes.Extensions

@{
    ViewBag.Title = "Home Page";
    Layout = "~/Views/Shared/_LandingPageLayout.cshtml";
}

@section Styles
{
    <style>
        .btn {
            height: 100px;
            margin: 20px auto;
        }
    </style>
}

<div class="container">
    <div class="row">

        <div class="col-xs-12 fullWidthButton" style="background-color:#9CB4F0; margin-top:70px;">
            <span class="fa fa-cutlery"><span class="icon_text ">Find a Restaurant</span></span>
        </div>

        <div class="col-xs-12 fullWidthButton" style="background-color:#F3BA71;">
            <span class="fa fa-map-marker"><span class="icon_text ">Check In</span></span>      
        </div>

        <div class="col-xs-12 fullWidthButton" style="background-color:#FF84A7;">
            <span class="fa fa-camera"><span class="icon_text ">Share Picture</span></span>
            
        </div>

        <div class="col-xs-12 fullWidthButton" style="background-color:#7BECED;">
           
            <span class="fa fa-money"><span class="icon_text">My Points</span></span>
        </div>

        <div class="col-xs-12 fullWidthButton" style="background-color:#BD84D6;">
            <span class="fa fa-user"><span class="icon_text ">My Profile</span></span>
            
        </div>
        @*<div class="feedContainer col-md-6 col-md-offset-3 col-xs-12">

            <div class="feedControlBox text-center">
                <a class="fa fa-cutlery btn btn-block" id="findLoc" style="margin-top:20px;"><br /><span class="icon_text ">Find a Restaurant</span></a>
                <hr />
                <a class="fa fa-map-marker btn btn-block" id="checkIn" href="/checkin#/selectionLoaded"><br /><span class="icon_text">Check In</span></a>
                <hr />
                <a class="fa fa-camera btn btn-block" id="sharePictures" href="/photoupload"><br /><span class="icon_text">Share Pictures</span></a>
                <hr />
                <a class="fa fa-money btn btn-block" id="myPoints" href="/myPoints"><br /><span class="icon_text">My Points</span></a>

            </div>*@
    </div>
</div>

</div>

<script type="application/json" id="modelData">
    @Html.RawJson(Model.AppUser)
</script>

@section scripts{
    <script type="text/javascript">
        var currentLocation = null;

        tkj.page.startUp = function () {
            $('#findLoc').on('click', tkj.page.handlers.onFindLoc);
            var userData = JSON.parse($("#modelData").html());
            console.log("user is ", userData);
            tkj.page.getPosition();
        }

        tkj.page.getPosition = function () {
            if (navigator.geolocation) {
                navigator.geolocation.getCurrentPosition(function (position) {
                    $.ajax({
                        type: 'GET',
                        url: 'https://maps.googleapis.com/maps/api/geocode/json?latlng=' + position.coords.latitude + ',' + position.coords.longitude,
                        datatype: 'jsonp',
                        success: tkj.page.handlers.success,
                        error: tkj.page.handlers.error
                    });
                });
            }
        }

        tkj.page.handlers.onFindLoc = function () {
            window.location.replace("/Results/location/" + currentLocation);
        }

        tkj.page.handlers.success = function (data) {
            console.log(data, "DATA");
            var str = data.results[1].address_components[1].long_name;
            currentLocation = str.replace(/\s+/g, '-');
            if (currentLocation != null) {
                $('.').text("Find a Restaurant in " + currentLocation);
            } else {
                $('#findLoc').prop('disabled', true);
            }

            currentLocation = currentLocation.toLowerCase();
            console.log("location is ", currentLocation);
        }

        tkj.page.handlers.error = function (data) {
            alert("Please turn on your loction service.");
        }



    </script>
}