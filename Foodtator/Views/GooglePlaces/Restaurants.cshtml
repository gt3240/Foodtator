@{
    ViewBag.Title = "Home Page";
    Layout = "~/Views/Shared/_LandingPageLayout.cshtml";
}

@section Styles
{
    <link href="~/Content/jquery.fullPage.css" rel="stylesheet" />
}

<h2>@ViewBag.Message</h2>
<div>

    <br />
    <br />

    @*@using (Html.BeginForm("Results", "Home", FormMethod.Get))
        {
            @Html.ValidationSummary(true, "Please enter a search term and location")
            <div>
                <fieldset>
                    <legend>Try YelpSharp!</legend>

                    <div class="editor-label">
                        @Html.LabelFor(m => m.Term)
                    </div>
                    <div class="editor-field">
                        @Html.TextBoxFor(m => m.Term)
                        @Html.ValidationMessageFor(m => m.Term)
                    </div>

                    <div class="editor-label" >
                        @Html.LabelFor(m => m.Location)
                    </div>
                    <div class="editor-field">
                        @Html.TextBoxFor(m => m.Location)
                        @Html.ValidationMessageFor(m => m.Location)
                    </div>

                    <p>
                        <input type="submit" value="Search Yelp" />
                    </p>
                </fieldset>
            </div>*@
    }

</div>
@section scripts{
    <script type="text/javascript">

    if (navigator.geolocation) {
        navigator.geolocation.getCurrentPosition(function (position) {
                $.ajax({
                    type: 'GET',
                    url: 'https://maps.googleapis.com/maps/api/geocode/json?latlng=' + position.coords.latitude + ',' + position.coords.longitude ,
                    datatype: 'jsonp',
                    success: tkj.page.handlers.success,
                    error:tkj.page.handlers.error
                });

        });
       
    }

    tkj.page.handlers.success = function (data) {
        console.log(data);
        var str = data.results[3].address_components[1].long_name;
        str = str.replace(/\s+/g, '-').toLowerCase();

        window.location.replace("/Results/" + str);
    }

    tkj.page.handlers.error = function () {
        alert("success");
    }


    </script>
}